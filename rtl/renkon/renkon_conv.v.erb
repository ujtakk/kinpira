% load "renkon.rb"

module renkon_conv(/*AUTOARG*/);
`include "renkon.vh"

  /*AUTOINPUT*/

  /*AUTOOUTPUT*/

  /*AUTOWIRE*/

  /*AUTOREG*/

  // AUTO_CONSTANT (DWIDTH)

  /* renkon_conv_tree25 AUTO_TEMPLATE (
      <%- for i in 0...25 -%>
      .pixel<%=i%>  (pixel_in<%=i%>[DWIDTH-1:0]),
      <%- end -%>
      .fmap         (result[DWIDTH-1:0]),
  ); */
  renkon_conv_tree25 tree(/*AUTOINST*/);

  renkon_conv_wreg wreg(/*AUTOINST*/);

  /* renkon_mem_feat AUTO_TEMPLATE (
      .mem_rdata1 (),
      .mem_wdata1 (feat_wdata[DWIDTH-1:0]),
      .mem_we1    (mem_feat_we),
      .mem_addr1  (mem_feat_addr_d1[FACCUM-1:0]),
      .mem_rdata2 (feat_rdata[DWIDTH-1:0]),
      .mem_wdata2 ({DWIDTH{1'b0}}),
      .mem_we2    (1'b0),
      .mem_addr2  (mem_feat_addr[FACCUM-1:0]),
  ); */
  renkon_mem_feat mem_feat(/*AUTOINST*/);

  /* renkon_accum AUTO_TEMPLATE (
      .pixel_in (result[DWIDTH-1:0]),
      .reset    (mem_feat_rst),
      .sum_old  (feat_rdata[DWIDTH-1:0]),
      .sum_new  (feat_wdata[DWIDTH-1:0]),
  ); */
  renkon_accum feat_accum(/*AUTOINST*/);

endmodule
